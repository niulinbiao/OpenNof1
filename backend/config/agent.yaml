# Agent Configuration

agent:
  # LLM Configuration - Compatible with any OpenAI API format
  model_name: "MiniMax-M2"  # Model name (gpt-4o, claude-3-5-sonnet, deepseek-chat, qwen-plus, etc.)
  base_url: "https://ai.gitee.com/v1"  # API base URL (null for OpenAI, or custom like "https://api.deepseek.com/v1")
  api_key: "${OPENAI_API_KEY}"  # API key environment variable
  
  # Trading Configuration
  decision_interval: 180  # seconds between decisions
  symbols:
    - ETHUSDT
    - SOLUSDT
    - DOGEUSDT
    - XRPUSDT
  timeframes:
    - "3m"
    - "1h"
    - "4h"
  
  # 用户可配置的交易策略（会被数据库覆盖）
  trading_strategy: |
    策略前提／风控设定:
    - 单一币种一次建仓最大不超过 可用余额 的 20%。  
    - 止损／止盈设定: 以小时级 NATR 为单位 (例如用当前 NATR * k)，盈亏比设为 2:1。  
    - 不要随意建仓 —— 只有当所有关键指标一致指向同一方向时 (趋势、波动性、量／成交、动能 等) 才考虑建仓。  
    - 不要随意主动平仓 —— 已设置止损／止盈后，除非出现强烈趋势反转信号，否则维持持仓。  
    
    入场逻辑 (开多／开空):
    - 计算近期 NATR (例如过去 14 根小时线)，并根据当前价格波动与 NATR 判断市场是否处于“合适波动／趋势启动”阶段。  
    - 如果 NATR 显著上升 (例如突破其近期均值)，说明波动性放大 → 市场可能进入大幅波动阶段，适合趋势交易或突破交易。  
    - 同时确认趋势方向 (可以用趋势指标，比如均线、动量、ADX／DI／MACD 等) 和成交量／动能辅助信号 —— 只有当趋势与波动性和动量共同指向同一方向时，才考虑建仓。  
    
    止损／止盈逻辑:
    - 止损设置为入场价 ± (NATR * k1)，止盈设置为入场价 + (方向 × NATR * k2)，且 k2 ≈ 2 * k1 以符合盈亏比 2:1。  
    - 随着价格移动，可以考虑将止损跟踪 (trailing stop) —— 例如用波动性停止 (类似于 “Volatility Stop / Chandelier Exit” 思路，用 NATR 或 ATR 动态调整止损), 以保护盈利。  
    
    平仓／加仓规则:
    - 不主动平仓，除非有强烈趋势反转信号 (例如趋势指标反转 + 波动性下降 + 动量逆转／成交量萎缩)。  
    - 若价格朝有利方向运行，可考虑分批加仓 (不过总仓位仍 ≤ 可用余额 20%)。  
    - 加仓／加仓前也必须满足所有指标一致 (趋势 + 波动 + 动量 + 成交量 等) 。  
    
    风险控制／资金管理:
    - 总仓位风险分散 —— 不把所有资金压在一个币种或一个方向上。  
    - 使用 NATR 作为 “波动性滤波器 (volatility filter)” —— 若 NATR 太低 (行情太平)，避免入场；若 NATR 太高 (过度波动或躁动)，适当缩减仓位或等待稳定。  
    - 保持冷静 / 避免情绪交易 (遵守规则，不被 FOMO 诱惑) 。  
    
    记录／复盘:
    - 每次入场／出场都记录 NATR 值、入场价、止损价、止盈价、成交量、趋势／动量指标值。  
    - 定期统计胜率、盈亏比、最大回撤、每笔交易波动性 (NATR 倍数) 等，以评估策略表现、优化参数。  


# Exchange Configuration
exchange:
  name: "binance_futures"
  api_key: "${BINANCE_API_KEY}"
  api_secret: "${BINANCE_API_SECRET}"
  testnet: false  # Use testnet for development
  
  # WebSocket and REST API endpoints
  websocket_url: "wss://fstream.binance.com/stream"  # Production
  rest_api_url: "https://fapi.binance.com"  # Production
  
  # Testnet endpoints (used when testnet: true)
  testnet_websocket_url: "wss://stream.binancefuture.com/stream"
  testnet_rest_api_url: "https://testnet.binancefuture.com"
  
  # Futures trading settings (for CCXT)
  default_leverage: 1
  margin_mode: "cross"  # cross or isolated
  enable_rate_limit: true
  timeout: 10000  # milliseconds
  retries: 3
  sandbox: false  # CCXT sandbox mode (alternative to testnet)
  
# Risk Management (these can be overridden in user prompts)
default_risk:
  max_position_size_percent: 0.1  # 10% of account per position
  max_daily_loss_percent: 0.05    # 5% max daily loss
                # Maximum leverage
  stop_loss_percent: 0.02         # 2% stop loss
  
# Account Snapshot Configuration
account_snapshot:
  enabled: true
  interval_minutes: 15  # Take snapshot every 15 minutes
  keep_days: 90  # Keep snapshots for 90 days

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  save_decisions: true
  save_executions: true
  save_snapshots: true
  
# System Configuration  
system:
  host: "0.0.0.0"
  port: 8000
  max_concurrent_decisions: 1  # Prevent overlapping decisions
  allow_control_operations: true  # 是否允许前端控制操作（启动/停止 agent、修改策略等）